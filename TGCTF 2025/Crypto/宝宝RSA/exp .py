from math import gcd

from Crypto.Util.number import long_to_bytes, inverse
from gmpy2 import gmpy2
from tqdm import tqdm

p1 = 8362851990079664018649774360159786938757293294328116561219351503022492961843907118845919317399785168488103775809531198339213009936918460080250107807031483
q1 = 8312546034426788223492083178829355192676175323324230533451989649056072814335528263136523605276378801682321623998646291206494179416941978672637426346496531
c1 = 39711973075443303473292859404026809299317446021917391206568511014894789946819103680496756934914058521250438186214943037578346772475409633145435232816799913236259074769958139045997486622505579239448395807857034154142067866860431132262060279168752474990452298895511880964765819538256786616223902867436130100322
n2 = 103873139604388138367962901582343595570773101048733694603978570485894317088745160532049473181477976966240986994452119002966492405873949673076731730953232584747066494028393377311943117296014622567610739232596396108513639030323602579269952539931712136467116373246367352649143304819856986264023237676167338361059
c2 = 51380982170049779703682835988073709896409264083198805522051459033730166821511419536113492522308604225188048202917930917221
e2 = 3
phi1=(p1-1)*(q1-1)
flag=b''
for e in tqdm(range(2**18-1,2**17,-1)):
    if gcd(e,phi1)==1:
        # print(e)
        m=long_to_bytes(pow(c1,inverse(e,phi1),p1*q1))
        # print(m)
        if b'TGCTF{' in m:
            print(m)
            flag+=m
            break
n2 = 103873139604388138367962901582343595570773101048733694603978570485894317088745160532049473181477976966240986994452119002966492405873949673076731730953232584747066494028393377311943117296014622567610739232596396108513639030323602579269952539931712136467116373246367352649143304819856986264023237676167338361059
c2 = 51380982170049779703682835988073709896409264083198805522051459033730166821511419536113492522308604225188048202917930917221
e2 = 3
mm=int(gmpy2.iroot(c2,e2)[0])
print(mm)
print(long_to_bytes(mm))
flag+=long_to_bytes(mm)
print(flag)
# b'TGCTF{!!3xP_Is_Sm@ll_But_D@ng3r0}'
